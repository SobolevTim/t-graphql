# Проект "GraphQL API"

Это проект, который реализует GraphQL API для обработки данных. Он использует Docker для развертывания базы данных PostgreSQL и самого API-сервера. Также включены unit-тесты для проверки работы всех компонентов.

## Описание

В рамках задания выполнено:

- Разработан **GraphQL API**, позволяющий взаимодействовать с данными через запросы и мутации.
- Используется **PostgreSQL** для хранения данных. Для развертывания базы данных использован Docker.
- Реализованы **unit-тесты**, покрывающие бизнес-логику, взаимодействие с хранилищем данных и обработку запросов.
- Используется **docker-compose** для упрощения запуска всех сервисов.
- Добавлены два скрипта для автоматизации запуска: один для сборки и запуска API и базы данных, другой для запуска тестов.

## Запуск проекта

### 1. Запуск API и базы данных

Для запуска проекта с помощью Docker выполните следующий скрипт:

```bash
./scripts/build_and_run.sh
```
Скрипт выполнит следующие действия:

- Соберёт Docker образы для API и базы данных.
- Развернёт контейнеры с PostgreSQL и API-сервером.
- API будет доступен по порту 8080, а база данных — по порту 5432.

### 2. Запуск тестов
Для запуска тестов выполните следующий скрипт:
```bash
./scripts/tests.sh
```
Скрипт выполнит следующие действия:

- Запустит все unit-тесты, покрывающие бизнес-логику, работу с данными и обработку запросов.
- Для тестирования будет использована in-memory база данных или моки, чтобы не затруднять выполнение тестов реальными операциями с базой данных.

## Структура проекта
```
t-graphql/
├── cmd/
│   ├── api/                  # Запуск API и GraphQL playground для удобства тестирования
├── db/
│   ├── schema.sql            # Схема БД
├── docker/
│   ├── init/                 # Схема init.sql - для Dockerfile-db
│   ├── Dockerfile-api        # Dockerfile для API
│   ├── Dockerfile-db         # Dockerfile для базы данных
│   └── docker-compose.yml    # docker-compose для управления сервисами
├── internal/
│   ├── config/               # Получение STORAGE_TYPE и DATABASE_URL из переменных окружения
│   ├── service/              # Сервисы бизнес-логики
│   ├── store/                # Логика работы с хранилищем данных
│   └── graph/                # Обработчики GraphQL запросов
├── scripts/
│   ├── build_and_run.sh      # Скрипт для запуска API и базы данных
│   └── tests.sh              # Скрипт для запуска тестов
└── go.mod                    # Модули Go
└── gqlgen.yml                # Gqlgen файл конфигурации
```

## Настройка окружения
Перед запуском проекта необходимо настроить несколько переменных окружения. Пример .env файла:
```
STORAGE_TYPE memory или postgres
```
Данные для postgres ДБ
```
STORAGE_TYPE=postgres
DB_USER=your_db_user
DB_PASSWORD=your_db_password
DB_NAME=your_db_name
```
## Технологии
- Go (1.23) — Основной язык программирования для разработки API.
- PostgreSQL — База данных для хранения данных.
- Docker — Используется для контейнеризации API и базы данных.
- GraphQL — Используется для создания API.
- Testing — Используется для юнит-тестирования.
- docker-compose — Для управления контейнерами.